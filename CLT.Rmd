---
title: "Investigation of Central Limit Theorem"
author: "Kevin Tham"
date: "April 25, 2018"
output:
  html_document:
    keep_md: true
  pdf_document: default
---

```{r setup, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
```

# Simulation Exercise

```{r, message=FALSE}
if (!require("pacman"))
  install.packages("pacman", repos = "http://cran.us.r-project.org")
pacman::p_load(knitr, dplyr, ggplot2, tidyr, grid, gridExtra)
```

## Overview

In this exercise we investigate the exponential distribution and compare it with the Central Limit Theorem. We expect that the means from a large number of identical exponential distributions will themselves form a normal distribution with known mean and standard deviation

We set the seed to ensure that the following analysis is reproducible:

```{r, include=TRUE}
set.seed(123)
```

We prepare a thousand repetitions of 40 samples drawn from an exponential distribution.

```{r}
lambda <- 0.2
n <- 40
rep <- 1000
rawdat <- rexp(40000, rate = lambda)
matdat <- matrix(rawdat, rep, n)
```

```{r}
th_mean <- 1/lambda
th_var <- (1/lambda)^2/n
th_sd <- sqrt(th_var)
```

From our simulated data we can obtain the sample mean:

```{r}
means <- apply(matdat, 1, mean)
sample_mean <- mean(means)
variance <- var(means)

print(variance)
```

```{r, fig.align='center', fig.height=3, fig.width=4.5}
bw = 0.3

df_means <- data.frame('means'= means)

ggplot(df_means, aes(means)) + geom_histogram(aes(y=..density..), binwidth=bw) +
  stat_function(fun=function(means) dnorm(means, mean=th_mean, sd=th_sd)) +
  labs(title='Scaled Histogram of means drawn from \n exponential distribution',
       x = 'Means', y = 'Density')
```
